
<header class="header">
  <div class="nav">
    <button class="back-btn" (click)="goBack()" title="Torna indietro">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="m15 18-6-6 6-6"/>
      </svg>
    </button>
    <img src="assets/LabTV-Loghi/2-blu.png" class="logo" alt="LabTV Logo" (click)="onLogoClick()" style="cursor: pointer;" />
    <ul>
      <li><a (click)="goToHome()">Home</a></li>
      <li><a (click)="goToContact()">Contattaci</a></li>
      <li><a (click)="logout()">Logout</a></li>
    </ul>
  </div>
</header>


<main class="main-content">
  <div class="container">
    <div class="page-header">
      <h1>I Miei Acquisti</h1>
      <p>Gestisci i tuoi film acquistati</p>
    </div>

    
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Caricamento acquisti...</p>
    </div>

    
    <div *ngIf="!isLoading && purchases.length === 0" class="empty-state">
      <div class="empty-icon">üé¨</div>
      <h2>Nessun acquisto trovato</h2>
      <p>Non hai ancora acquistato nessun film. Inizia a esplorare il nostro catalogo!</p>
      <button class="btn-primary" (click)="goToHome()">Esplora Catalogo</button>
    </div>

    
    <div *ngIf="!isLoading && purchases.length > 0" class="purchases-list">
      <div class="purchase-card" *ngFor="let purchase of purchases">
        <div class="purchase-info">
          <h3 class="movie-title">
            {{ purchase.movieTitle || 'Titolo non disponibile' }}
            <span *ngIf="purchase.type === 'season'" class="season-badge">
              - {{ purchase.seasonName || 'Stagione ' + purchase.seasonNumber }}
            </span>
          </h3>
          <div class="purchase-details">
            <span class="purchase-date">{{ formatDate(purchase.purchaseDate) }}</span>
            <span class="purchase-price">‚Ç¨{{ purchase.price }}</span>
            <span class="purchase-type" [class]="'type-' + (purchase.type || 'movie')">
              {{ purchase.type === 'season' ? 'Stagione' : 'Film' }}
            </span>
            <span class="purchase-status" [class]="'status-' + purchase.status">
              {{ purchase.status === 'completed' ? 'Completato' : purchase.status === 'pending' ? 'In sospeso' : 'Cancellato' }}
            </span>
          </div>
        </div>
        
        <div class="purchase-actions">
          <button 
            *ngIf="purchase.status === 'completed'" 
            class="btn-watch">
            ‚ñ∂Ô∏è Guarda
          </button>
          
          <button 
            *ngIf="canCancelPurchase(purchase)" 
            class="btn-cancel"
            (click)="cancelPurchase(purchase.id)">
            ‚ùå Cancella
          </button>
          
          <span 
            *ngIf="!canCancelPurchase(purchase) && purchase.status === 'completed'" 
            class="no-cancel">
            Non cancellabile (oltre 24h)
          </span>
        </div>
      </div>
    </div>
  </div>
</main>


<footer class="footer">
  <div class="footer-content">
    <img src="assets/LabTV-Loghi/2-blu.png" class="logo" alt="LabTV Logo" (click)="onLogoClick()" style="cursor: pointer;" />
    <div class="social-links">
      <h4>Seguici sui social</h4>
      <div class="social-icons">
        <a href="#" class="social-icon"><img src="assets/LabTV-Loghi/ig.png" alt="Instagram"></a>
        <a href="#" class="social-icon"><img src="assets/LabTV-Loghi/twt.png" alt="Twitter"></a>
        <a href="#" class="social-icon"><img src="assets/LabTV-Loghi/yt.png" alt="YouTube"></a>
        <a href="#" class="social-icon"><img src="assets/LabTV-Loghi/fb.png" alt="Facebook"></a>
        <a href="#" class="social-icon"><img src="assets/LabTV-Loghi/wsp.png" alt="Whatsapp"></a>
      </div>
    </div>
  </div>
  <div class="footer-links">
    <a href="#">FAQ</a>
    <a href="#">Centro assistenza</a>
    <a href="#">Termini d'uso</a>
    <a href="#">Privacy</a>
  </div>
  <div class="footer-copy">
    &copy; 2025 LabTV. Tutti i diritti riservati.
  </div>
</footer>
